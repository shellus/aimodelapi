# 功能介绍：通用配置管理 (General Configuration)

通用配置功能允许用户维护多套 `~/.claude/settings.json` 的配置模板，并能一键应用到系统配置中，同时保持当前 Provider 的切换状态。

## 核心价值

在 Claude Code 中，`settings.json` 同时存储了：
1. **环境变量**：由 Provider 管理器维护（如 `ANTHROPIC_AUTH_TOKEN`）。
2. **通用设置**：如权限控制（permissions）、插件启用状态（enabledPlugins）、主题（theme）、状态栏（statusLine）等。

**通用配置功能解决了“在切换高级设置时不想破坏当前 Provider 认证信息”的问题。**

## 工作原理：ENV 保护策略

当您点击“应用此配置”时，系统执行以下逻辑：
1. **读取**：获取当前的 `~/.claude/settings.json` 内容。
2. **备份**：提取并锁定当前的 `env` 字段（包含当前 Provider 的 Key 和 URL）。
3. **合并**：将您选择的通用配置模板通过“深合并（Deep Merge）”算法合并到当前配置中。
4. **还原**：强制将备份的 `env` 字段写回合并后的配置。
5. **持久化**：写入磁盘。

这确保了您可以快速切换不同的权限集或插件组合，而不会导致当前正在使用的 Provider 失效。

## 使用指南

### 1. 进入管理页面
在首页工具栏右侧，点击 **“调节（Adjustments）”** 图标（位于“添加”按钮左侧）即可进入通用配置模板列表。

### 2. 创建模板
- 点击“添加模板”。
- **名称**：起一个易于识别的名字，如“全能开发模式”或“极简安全模式”。
- **配置内容**：输入合法的 JSON 字符串。
    - 例如，开启所有权限的配置：
      ```json
      {
        "permissions": {
          "allow": ["Bash", "Edit", "Write", "Read", "Glob", "Grep", "Skill"]
        }
      }
      ```

### 3. 应用模板
在列表页点击 **“应用此配置”**。
- **效果**：系统会立即更新 `~/.claude/settings.json`。
- **注意**：Provider 管理器中标记为“已激活”的供应商信息将自动得到保护。

### 4. 预置模板
系统已根据您提供的 SQL 导出文件预置了 **“标准生产环境配置”**，包含了：
- 完善的权限白名单（包含 MCP 服务权限）。
- 生产环境常用的插件配置。
- 状态栏自定义设置。

## 注意事项
- 模板内容必须是有效的 JSON 格式。
- 应用配置是破坏性的操作（除了 `env` 字段会被保护外，其他同名键会被覆盖），建议在应用前确认模板内容。
